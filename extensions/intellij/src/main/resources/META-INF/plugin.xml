<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <id>com.yinhai.TA3AiPlugin</id>
    <name>TA+3 New Coder</name>
    <vendor url="http://172.20.23.216/">技术研发部-AI开发技术组</vendor>
    <change-notes>
        <![CDATA[
        查看最新的 <a href="http://172.20.23.216/ta3-ai-doc/docs/docs/code/README.html">文档</a>
        ]]>
    </change-notes>

    <depends>com.intellij.modules.platform</depends>

    <!-- See here for why this is optional:  https://github.com/continuedev/continue/issues/2775#issuecomment-2535620877-->
    <depends optional="true" config-file="continueintellijextension-withJSON.xml">
        com.intellij.modules.json
    </depends>

    <depends optional="true">Git4Idea</depends>
    <depends optional="true" config-file="java-plugin.xml">com.intellij.java</depends>

    <!-- com.intellij.openapi.module.ModuleManager.Companion is only available since this build -->
    <idea-version since-build="223.7571.182"/>

    <extensions defaultExtensionNs="com.intellij">
        <editorFactoryListener
                implementation="com.github.continuedev.continueintellijextension.autocomplete.AutocompleteEditorListener"/>
        <toolWindow id="TA+3 牛码" anchor="right" icon="/tool-window-icon.svg"
                    factoryClass="com.github.continuedev.continueintellijextension.toolWindow.ContinuePluginToolWindowFactory"/>
        <projectService id="ContinuePluginService"
                        serviceImplementation="com.github.continuedev.continueintellijextension.services.ContinuePluginService"/>
        <projectService
                id="DiffStreamService"
                serviceImplementation="com.github.continuedev.continueintellijextension.editor.DiffStreamService"/>
        <projectService
                id="AutocompleteLookupListener"
                serviceImplementation="com.github.continuedev.continueintellijextension.autocomplete.AutocompleteLookupListener"/>
        <statusBarWidgetFactory
                implementation="com.github.continuedev.continueintellijextension.autocomplete.AutocompleteSpinnerWidgetFactory"
                id="AutocompleteSpinnerWidget"/>
        <notificationGroup id="Continue"
                           displayType="BALLOON"/>
        <actionPromoter order="last"
                        implementation="com.github.continuedev.continueintellijextension.actions.ContinueActionPromote"/>
    </extensions>

    <resource-bundle>messages.MyBundle</resource-bundle>

    <extensions defaultExtensionNs="com.intellij">
        <postStartupActivity
                implementation="com.github.continuedev.continueintellijextension.activities.ContinuePluginStartupActivity"/>
        <applicationConfigurable
                parentId="tools"
                instance="com.github.continuedev.continueintellijextension.services.ContinueExtensionConfigurable"
                id="com.github.continuedev.continueintellijextension.services.ContinueExtensionConfigurable"
                displayName="TA+3 牛码"/>
        <applicationService
                serviceImplementation="com.github.continuedev.continueintellijextension.services.ContinueExtensionSettings"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <codeInsight.inlayProvider language="JAVA" implementationClass="com.github.continuedev.continueintellijextension.lens.TabnineLensJavaProvider" />
        <codeInsight.inlayProvider language="TypeScript" implementationClass="com.github.continuedev.continueintellijextension.lens.TabnineLensTypescriptProvider" />
        <codeInsight.inlayProvider language="Python" implementationClass="com.github.continuedev.continueintellijextension.lens.TabnineLensPythonProvider" />
        <codeInsight.inlayProvider language="kotlin" implementationClass="com.github.continuedev.continueintellijextension.lens.TabnineLensKotlinProvider" />
        <codeInsight.inlayProvider language="PHP" implementationClass="com.github.continuedev.continueintellijextension.lens.TabnineLensPhpProvider" />
        <codeInsight.inlayProvider language="Rust" implementationClass="com.github.continuedev.continueintellijextension.lens.TabnineLensRustProvider"  />
        <jvm.exceptionFilter implementation="com.github.continuedev.continueintellijextension.filter.TaAiDebuggerFilter"/>
    </extensions>

    <actions>
        <action class="com.github.continuedev.continueintellijextension.editor.InlineEditAction"
                id="continue.inlineEdit"
                description="Inline Edit"
                text="Inline Edit">
            <keyboard-shortcut keymap="$default"
                               first-keystroke="ctrl I"/>
            <keyboard-shortcut keymap="Mac OS X"
                               first-keystroke="meta I"/>
            <override-text place="GoToAction" text="Continue: Edit Code"/>
        </action>

        <action id="continue.acceptDiff"
                class="com.github.continuedev.continueintellijextension.actions.AcceptDiffAction"
                text="Accept Diff" description="Accept Diff">
            <keyboard-shortcut keymap="$default"
                               first-keystroke="shift ctrl ENTER"/>
            <keyboard-shortcut keymap="Mac OS X"
                               first-keystroke="shift meta ENTER"/>
            <override-text place="GoToAction" text="Continue: Accept Diff"/>
        </action>

        <action id="continue.rejectDiff"
                class="com.github.continuedev.continueintellijextension.actions.RejectDiffAction"
                text="Reject Diff" description="Reject Diff">
            <keyboard-shortcut keymap="$default"
                               first-keystroke="shift ctrl BACK_SPACE"/>
            <keyboard-shortcut keymap="Mac OS X"
                               first-keystroke="shift meta BACK_SPACE"/>
            <override-text place="GoToAction" text="Continue: Reject Diff"/>
        </action>

        <action id="continue.acceptVerticalDiffBlock"
                class="com.github.continuedev.continueintellijextension.actions.AcceptDiffAction"
                text="Accept Diff" description="Accept Vertical Diff Block">
            <keyboard-shortcut keymap="$default"
                               first-keystroke="alt shift Y"/>
            <keyboard-shortcut keymap="Mac OS X"
                               first-keystroke="alt shift Y"/>
            <override-text place="GoToAction" text="Continue: Accept Vertical Diff Block"/>
        </action>

        <action id="continue.rejectVerticalDiffBlock"
                class="com.github.continuedev.continueintellijextension.actions.RejectDiffAction"
                text="Reject Diff" description="Reject Vertical Diff Block">
            <keyboard-shortcut keymap="$default"
                               first-keystroke="alt shift N"/>
            <keyboard-shortcut keymap="Mac OS X"
                               first-keystroke="alt shift N"/>
            <override-text place="GoToAction" text="Continue: Reject Vertical Diff Block"/>
        </action>

        <action id="continue.focusContinueInputWithoutClear"
                class="com.github.continuedev.continueintellijextension.actions.FocusContinueInputWithoutClearAction"
                text="Add selected code to context"
                description="Focus Continue Input With Edit">
            <keyboard-shortcut keymap="$default"
                               first-keystroke="ctrl shift J"/>
            <keyboard-shortcut keymap="Mac OS X"
                               first-keystroke="meta shift J"/>
            <override-text place="GoToAction" text="Continue: Add Highlighted Code to Context"/>
        </action>

        <action id="continue.newContinueSession"
                icon="AllIcons.General.Add"
                class="com.github.continuedev.continueintellijextension.actions.NewContinueSessionAction"
                text="新会话"
                description="新会话">

            <override-text place="GoToAction" text="新会话"/>
        </action>

        <action id="continue.viewHistory"
                icon="AllIcons.Vcs.History"
                class="com.github.continuedev.continueintellijextension.actions.ViewHistoryAction"
                text="历史会话"
                description="历史会话">
            <override-text place="GoToAction" text="历史会话"/>
        </action>

        <action id="continue.openConfigPage"
                class="com.github.continuedev.continueintellijextension.actions.OpenConfigAction"
                icon="AllIcons.General.ExternalTools"
                text="配置项"
                description="配置项">
            <override-text place="GoToAction" text="配置项"/>
        </action>

        <action id="continue.setTopRightAnchor"
                class="com.github.continuedev.continueintellijextension.actions.SetTopRightAnchorAction"
                icon="AllIcons.General.ArrowRight"
                text="居右展示"
                description="居右展示" />

        <action id="continue.setBottomLeftAnchor"
                class="com.github.continuedev.continueintellijextension.actions.SetBottomLeftAnchorAction"
                icon="AllIcons.General.ArrowDown"
                text="居下展示"
                description="居下展示" />

        <action id="continue.openLogs"
                class="com.github.continuedev.continueintellijextension.actions.OpenLogsAction"
                icon="AllIcons.General.ShowInfos"
                text="Open Logs"
                description="Open Continue Logs">
            <override-text place="GoToAction" text="Open Continue Logs"/>
        </action>

        <group id="ContinueSidebarActionsGroup">
            <reference ref="continue.newContinueSession"/>
            <reference ref="continue.viewHistory"/>
            <reference ref="continue.setTopRightAnchor"/>
            <reference ref="continue.setBottomLeftAnchor"/>
            <reference ref="continue.openConfigPage"/>
        </group>

        <action id="continue.focusContinueInput"
                class="com.github.continuedev.continueintellijextension.actions.FocusContinueInputAction"
                text="Add selected code to context"
                description="Focus Continue Input">
            <keyboard-shortcut keymap="$default"
                               first-keystroke="ctrl J"/>
            <keyboard-shortcut keymap="Mac OS X"
                               first-keystroke="meta J"/>
            <add-to-group group-id="EditorPopupMenu"/>
            <override-text place="GoToAction" text="Continue: Add Highlighted Code to Context and Clear Chat"/>
        </action>

        <action id="com.github.continuedev.continueintellijextension.autocomplete.AcceptAutocompleteAction"
                class="com.github.continuedev.continueintellijextension.autocomplete.AcceptAutocompleteAction"
                text="Accept Autocomplete Suggestion" description="Accept Autocomplete Suggestion">
            <keyboard-shortcut keymap="$default" first-keystroke="TAB"/>
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="TAB"/>
        </action>

        <action id="com.github.continuedev.continueintellijextension.autocomplete.CancelAutocompleteAction"
                class="com.github.continuedev.continueintellijextension.autocomplete.CancelAutocompleteAction"
                text="Cancel Autocomplete Suggestion" description="Cancel Autocomplete Suggestion">
            <keyboard-shortcut keymap="$default" first-keystroke="ESCAPE"/>
        </action>

        <action id="com.github.continuedev.continueintellijextension.autocomplete.PartialAcceptAutocompleteAction"
                class="com.github.continuedev.continueintellijextension.autocomplete.PartialAcceptAutocompleteAction"
                text="Partial Accept Autocomplete Suggestion"
                description="Partial Accept Autocomplete Suggestion">
            <keyboard-shortcut first-keystroke="control alt RIGHT" keymap="$default"/>
            <keyboard-shortcut first-keystroke="alt meta RIGHT" keymap="Mac OS X"/>
        </action>

        <action id="TriggerCommitMessageGenerationAction" class="com.github.continuedev.continueintellijextension.actions.CommitMessageGenerationAction">
            <add-to-group group-id="Vcs.MessageActionGroup" anchor="first"/>
        </action>
    </actions>
</idea-plugin>
